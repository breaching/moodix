import{u as S,b as M,j as e,c as A,I as g,A as h,G as u}from"./index-nMGFLr7G.js";import{r as v}from"./vendor-F9Y4d3HK.js";import"./state-Ck21Aizr.js";const O=v.memo(function(){const{entries:c,currentEntry:p,updateEntry:f}=S(),{settings:N}=M(),r=l=>A(N.lang,l),x=v.useMemo(()=>{const i=Object.values(c).slice(-7),t=i.filter(a=>a.generalMood&&parseInt(String(a.generalMood),10)>0),s=t.reduce((a,o)=>a+parseFloat(String(o.generalMood)),0)/(t.length||1);let n=0,d=0;i.forEach(a=>{if(a.sleepHours&&a.sleepHours.length>0){const o=a.sleepHours.filter(Boolean).length;o>0&&(n+=o,d++)}});const y=d>0?n/d:0,w=i.reduce((a,o)=>o.activityLog?a+o.activityLog.reduce((m,k)=>{var j;return m+(((j=k.activities)==null?void 0:j.length)||0)},0):a,0),_=i.filter(a=>a.generalMood||a.sleepHours&&a.sleepHours.filter(Boolean).length>0||a.activityLog&&a.activityLog.some(o=>{var m;return((m=o.activities)==null?void 0:m.length)>0})).length;return{avgMood:s,avgSleep:y,totalActivities:w,completedDays:_}},[c]),b=v.useMemo(()=>{const l=[];Object.values(c).forEach(t=>{t.activityLog&&t.activityLog.forEach(s=>{var n;(n=s.activities)==null||n.forEach(d=>{d.name&&l.push({name:d.name,plaisir:d.plaisir||0})})})});const i=l.reduce((t,s)=>(t[s.name]||(t[s.name]={total:0,count:0}),t[s.name].total+=s.plaisir,t[s.name].count++,t),{});return Object.entries(i).map(([t,s])=>({name:t,avgPlaisir:s.total/s.count,count:s.count})).sort((t,s)=>s.avgPlaisir-t.avgPlaisir).slice(0,5)},[c]);return p?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",role:"region","aria-label":"Statistiques hebdomadaires",children:[e.jsxs("div",{className:"stat-card bg-gradient-to-br from-[var(--primary)]/20 to-[var(--primary-dark)]/10 rounded-xl p-4 shadow-lg shadow-[var(--primary)]/10 card-animated stagger-delay-1 hover:scale-[1.02] transition-transform border border-[var(--primary)]/20 backdrop-blur-sm",children:[e.jsx("div",{className:"text-xs text-[var(--text-secondary)] mb-1",children:r("last_week")}),e.jsx("div",{className:"text-2xl font-bold text-[var(--primary)]",children:e.jsx(h,{value:x.avgMood.toFixed(1)})}),e.jsx("div",{className:"text-xs text-[var(--text-muted)]",children:r("mood_trend")})]}),e.jsxs("div",{className:"stat-card bg-gradient-to-br from-blue-500/20 to-blue-600/10 rounded-xl p-4 shadow-lg shadow-blue-500/10 card-animated stagger-delay-2 hover:scale-[1.02] transition-transform border border-blue-500/20 backdrop-blur-sm",children:[e.jsx("div",{className:"text-xs text-[var(--text-secondary)] mb-1",children:r("last_week")}),e.jsxs("div",{className:"text-2xl font-bold text-blue-400",children:[e.jsx(h,{value:x.avgSleep.toFixed(1)}),"h"]}),e.jsx("div",{className:"text-xs text-[var(--text-muted)]",children:r("sleep_average")})]}),e.jsxs("div",{className:"stat-card bg-gradient-to-br from-emerald-500/20 to-emerald-600/10 rounded-xl p-4 shadow-lg shadow-emerald-500/10 card-animated stagger-delay-3 hover:scale-[1.02] transition-transform border border-emerald-500/20 backdrop-blur-sm",children:[e.jsx("div",{className:"text-xs text-[var(--text-secondary)] mb-1",children:r("last_week")}),e.jsx("div",{className:"text-2xl font-bold text-emerald-400",children:e.jsx(h,{value:x.totalActivities})}),e.jsx("div",{className:"text-xs text-[var(--text-muted)]",children:r("tab_activities")})]}),e.jsxs("div",{className:"stat-card bg-gradient-to-br from-orange-500/20 to-orange-600/10 rounded-xl p-4 shadow-lg shadow-orange-500/10 card-animated stagger-delay-4 hover:scale-[1.02] transition-transform border border-orange-500/20 backdrop-blur-sm",children:[e.jsx("div",{className:"text-xs text-[var(--text-secondary)] mb-1",children:r("last_week")}),e.jsxs("div",{className:"text-2xl font-bold text-orange-400",children:[e.jsx(h,{value:x.completedDays}),"/7"]}),e.jsx("div",{className:"text-xs text-[var(--text-muted)]",children:r("days_streak").replace("{count}","")})]})]}),e.jsxs(u,{className:"bg-[var(--bg-card)] rounded-2xl p-5 shadow-[var(--shadow-md)] card-animated stagger-delay-3",children:[e.jsxs("h3",{className:"text-xs font-bold text-[var(--text-secondary)] mb-4 uppercase tracking-wider flex items-center gap-2",children:[e.jsx("span",{className:"stats-icon",children:e.jsx(g.Chart,{})}),r("stats_sleep_mood")]}),e.jsx("div",{className:"h-40 flex items-center justify-center text-[var(--text-muted)] text-sm",children:Object.keys(c).length<3?r("no_data"):e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"flex items-end justify-around h-32 gap-1",children:Object.entries(c).slice(-7).map(([l,i])=>{var n;const t=parseInt(String(i.generalMood)||"0",10),s=((n=i.sleepHours)==null?void 0:n.filter(Boolean).length)||0;return e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-full bg-[var(--primary)]/60 rounded-t transition-all",style:{height:`${t*10}%`},title:`Humeur: ${t}/10`}),e.jsx("div",{className:"w-full bg-blue-400/60 rounded-t transition-all",style:{height:`${s/12*100}%`},title:`Sommeil: ${s}h`}),e.jsx("span",{className:"text-[8px] text-[var(--text-muted)]",children:new Date(l).getDate()})]},l)})})})})]}),e.jsxs(u,{className:"bg-[var(--bg-card)] rounded-2xl p-5 shadow-[var(--shadow-md)] card-animated stagger-delay-4",children:[e.jsxs("h3",{className:"text-xs font-bold text-[var(--text-secondary)] mb-4 uppercase tracking-wider flex items-center gap-2",children:[e.jsx("span",{className:"stats-icon",children:e.jsx(g.Brain,{})}),r("stats_thoughts")]}),e.jsx("textarea",{placeholder:r("stats_thoughts_ph"),value:p.thoughts,onChange:l=>f("thoughts",l.target.value),className:"w-full h-32 bg-input rounded-xl p-3 text-sm text-[var(--text-main)] focus:ring-2 focus:ring-[var(--primary)]/50 outline-none resize-none transition-colors","aria-label":r("stats_thoughts")})]}),e.jsxs(u,{className:"bg-[var(--bg-card)] rounded-2xl p-5 shadow-[var(--shadow-md)] card-animated stagger-delay-5",children:[e.jsxs("h3",{className:"text-xs font-bold text-[var(--text-secondary)] mb-4 uppercase tracking-wider flex items-center gap-2",children:[e.jsx("span",{className:"stats-icon",children:e.jsx(g.List,{})}),r("stats_top_act")]}),b.length===0?e.jsx("div",{className:"text-center text-[var(--text-muted)] text-sm py-4",children:r("no_data")}):e.jsx("div",{className:"space-y-2",children:b.map((l,i)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg bg-input",children:[e.jsx("span",{className:"text-lg font-bold text-[var(--primary)] w-6",children:i+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-semibold text-[var(--text-main)]",children:l.name}),e.jsxs("div",{className:"text-xs text-[var(--text-muted)]",children:[l.count," fois"]})]}),e.jsx("div",{className:"text-sm font-bold text-emerald-400",children:l.avgPlaisir.toFixed(1)})]},l.name))})]})]}):e.jsxs("div",{className:"text-center py-12 text-[var(--text-muted)]",children:[e.jsx(g.Loading,{className:"w-8 h-8 mx-auto mb-2"}),r("loading")]})});export{O as default};
//# sourceMappingURL=StatsTab-Bwefhe06.js.map
